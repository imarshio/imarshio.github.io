---
icon: pen-to-square
date: 2021-03-17
category:
  - mysql
title: ç´¢å¼• 
# tag:

---

> ç´¢å¼•æ˜¯ä¸€ä¸ªï¼ˆï¼Ÿï¼‰çš„ï¼ˆï¼Ÿï¼‰ã€‚
>  
> ç´¢å¼•æœ‰åˆ©æœ‰å¼Šã€‚åœ¨ä¼šç”¨çš„äººæ‰‹é‡Œï¼Œåˆ©å¤§å¤§å¤§äºå¼Šã€‚åœ¨ä¸ä¼šç”¨çš„äººæ‰‹é‡Œï¼Œåˆ©å¼Šä¸ç›¸ä¸Šä¸‹ï¼ˆç›®å‰çš„æˆ‘å°±æ˜¯è¿™ä¸ªçº§åˆ«ï¼Œæ‰€ä»¥è¯´èµ·ç´¢å¼•ï¼Œæˆ‘ä¹Ÿæ˜¯è’™çš„å¾ˆï¼‰ã€‚
>  
> é¦–å…ˆå•Šï¼Œç»è¿‡ä¸¤å¤©çš„åŸºç¡€å­¦ä¹ ï¼Œæˆ‘çŸ¥é“äº†è¦æƒ³çŸ¥é“ç´¢å¼•çš„å¥½åï¼Œé‚£ä¹ˆä½ å¿…é¡»è¦å…ˆäº†è§£ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Œç„¶åæ˜¯å®ƒçš„æ•°æ®ç»“æ„---B+æ ‘ã€‚å…¶æ¬¡ï¼Œä½ éœ€è¦çŸ¥é“å®ƒæ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Œå­˜å‚¨åœ¨å“ªï¼Œæ€ä¹ˆè°ƒç”¨ã€‚

## å‡†å¤‡

- B æ ‘
- B+ æ ‘
- B+ æ ‘
- B+ æ ‘
- ã€‚ã€‚ã€‚

### WHATï¼Ÿ

åœ¨å…³ç³»æ•°æ®åº“ä¸­ï¼Œç´¢å¼•æ˜¯ä¸€ç§**å•ç‹¬**çš„ã€**ç‰©ç†**çš„ï¼Œå¯¹æ•°æ®åº“è¡¨ä¸­çš„**ä¸€åˆ—æˆ–å¤šåˆ—**çš„å€¼è¿›è¡Œ**æ’åº**çš„ä¸€ç§**å­˜å‚¨ç»“æ„**ï¼ˆB+æ ‘ï¼‰ï¼Œä»–æ˜¯è¡¨ä¸­ä¸€åˆ—æˆ–å¤šåˆ—å€¼çš„é›†åˆå’Œä¸€ç³»åˆ—æŒ‡å‘å®é™…æ•°æ®çš„æŒ‡é’ˆé›†åˆï¼ˆç±»ä¼¼å­—å…¸K-Vï¼‰ã€‚

æ‰€ä»¥ï¼Œç´¢å¼•ç‹¬ç«‹äºæ•°æ®è¡¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥ç´¢å¼•ä¹Ÿæ˜¯**å­˜å‚¨åœ¨ç£ç›˜**ä¸Šçš„ï¼Œæ¯æ¬¡å¼€å¯MySQLå®¢æˆ·ç«¯åï¼Œä¼šåŠ è½½ç´¢å¼•æ–‡ä»¶åˆ°**å†…å­˜**ä¸­ã€‚

### WHYï¼Ÿ

ä¸ºä»€ä¹ˆä½¿ç”¨ç´¢å¼•ï¼Ÿ

å› ä¸ºç´¢å¼•èƒ½æé«˜æˆ‘ä»¬æŸ¥è¯¢çš„æ•ˆç‡ï¼Œä¸ºä»€ä¹ˆèƒ½å¤Ÿæé«˜æˆ‘ä»¬çš„æŸ¥è¯¢æ•ˆç‡ï¼Ÿè¿™å°±éœ€è¦è¯´ä¸€ä¸‹æ•°æ®åº“æŸ¥è¯¢çš„è¿‡ç¨‹ã€‚

å½“æ•°æ®åº“ä¸­æœ‰å¤§é‡æ•°æ®æ—¶ï¼Œæƒ³è¦æŸ¥è¯¢ä¸€æ¡æ•°æ®ï¼Œæœ€ç®€å•ç²—æš´çš„æ–¹å¼å°±æ˜¯é€ä¸€åŒ¹é…ï¼ˆå…¨è¡¨æœç´¢ï¼‰ï¼Œè¿™æ—¢æ˜¯æœ€æ…¢çš„ï¼Œæ…¢åœ¨ä¸¤ç‚¹ï¼Œå…¶ä¸€ï¼Œ**å¾…åŒ¹é…çš„æ•°æ®é‡**å¤§ä¸”**æ— åº**ï¼Œå…¶äºŒï¼ŒåŠ è½½æ•°æ®æ‰€éœ€çš„**IO**æ¬¡æ•°å¤šï¼Œä¹Ÿä¼šé€ æˆæ—¶é—´æµªè´¹ã€‚

ä¸ºäº†å‡å°‘ä¸Šé¢æ‰€éœ€æ—¶é—´ï¼Œæˆ‘ä»¬å°±éœ€è¦ä»è¿™ä¸¤æ–¹é¢ä¸‹æ‰‹ã€‚

æ‰€ä»¥å‡ºç°äº†ä»¥**B+æ ‘**ä¸ºæ•°æ®ç»“æ„çš„ç´¢å¼•ã€‚

B+æ ‘èƒ½ä¿è¯IOæ¬¡æ•°ä¸ä¼šå¤ªå¤šï¼Œç´¢å¼•æ˜¯è¡Œæ•°æ®çš„**å…³é”®å€¼**å¾—é›†åˆï¼Œä¿è¯äº†å°ä½“é‡çš„æ•°æ®ï¼Œä¸€ä¸ªç´¢å¼•æ–‡ä»¶èƒ½å¤Ÿå­˜å‚¨å¤§é‡çš„ç´¢å¼•ã€‚

åˆ›å»ºç´¢å¼•æ—¶ï¼Œä½ éœ€è¦ç¡®ä¿è¯¥ç´¢å¼•æ˜¯åº”ç”¨åœ¨ `SQL` æŸ¥è¯¢è¯­å¥çš„æ¡ä»¶(ä¸€èˆ¬ä½œä¸º `WHERE` å­å¥çš„æ¡ä»¶)ï¼Œå³ä¿è¯ç´¢å¼•èƒ½èµ·ä½œç”¨ã€‚

å®é™…ä¸Šï¼Œç´¢å¼•ä¹Ÿæ˜¯ä¸€å¼ è¡¨ï¼Œè¯¥è¡¨ä¿å­˜äº†ä¸»é”®ä¸ç´¢å¼•å­—æ®µï¼Œå¹¶æŒ‡å‘å®ä½“è¡¨çš„è®°å½•ã€‚

### ä¼˜ç‚¹

`MySQL`ç´¢å¼•çš„å»ºç«‹å¯¹äº `MySQL`çš„é«˜æ•ˆè¿è¡Œæ˜¯å¾ˆé‡è¦çš„ï¼Œç´¢å¼•å¯ä»¥å¤§å¤§æé«˜ `MySQL`çš„æ£€ç´¢é€Ÿåº¦ã€‚

æ‰“ä¸ªæ¯”æ–¹ï¼Œå¦‚æœåˆç†çš„è®¾è®¡ä¸”ä½¿ç”¨ç´¢å¼•çš„ `MySQL`æ˜¯ä¸€è¾†å…°åšåŸºå°¼çš„è¯ï¼Œé‚£ä¹ˆæ²¡æœ‰è®¾è®¡å’Œä½¿ç”¨ç´¢å¼•çš„ `MySQL`å°±æ˜¯ä¸€ä¸ªäººåŠ›ä¸‰è½®è½¦ã€‚

æ‹¿æ±‰è¯­å­—å…¸çš„ç›®å½•é¡µï¼ˆç´¢å¼•ï¼‰æ‰“æ¯”æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰æ‹¼éŸ³ã€ç¬”ç”»ã€åæ—éƒ¨é¦–ç­‰æ’åºçš„ç›®å½•ï¼ˆç´¢å¼•ï¼‰å¿«é€ŸæŸ¥æ‰¾åˆ°éœ€è¦çš„å­—ã€‚

### ç¼ºç‚¹

è™½ç„¶ç´¢å¼•å¤§å¤§æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼ŒåŒæ—¶å´ä¼šé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œå¦‚å¯¹è¡¨è¿›è¡Œ `INSERT`ã€`UPDATE`å’Œ `DELETE`ã€‚å› ä¸ºæ›´æ–°è¡¨æ—¶ï¼Œ`MySQL`ä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜è¦ä¿å­˜ä¸€ä¸‹ç´¢å¼•æ–‡ä»¶ã€‚

ç´¢å¼•æ–‡ä»¶ä¼šå ç”¨ç£ç›˜ç©ºé—´ï¼Œæ‰€ä»¥ï¼Œç´¢å¼•ä¸æ˜¯è¶Šå¤šè¶Šå¥½ã€‚

### åˆ†ç±»

æ ¹æ®åº•å±‚å®ç°å¯ä»¥åˆ†ä¸º**B-Treeç´¢å¼•**å’Œ**å“ˆå¸Œç´¢å¼•**ã€‚

æ ¹æ®å­˜å‚¨æ–¹å¼å¯ä»¥åˆ†**èšç°‡ç´¢å¼•**å’Œ**éèšç°‡ç´¢å¼•**ï¼Œä¸‹è¿˜å¯åˆ†ä¸º**å•åˆ—ç´¢å¼•**ã€**ç»„åˆç´¢å¼•**ã€**æ™®é€šç´¢å¼•**ã€**å”¯ä¸€ç´¢å¼•**ã€**è¦†ç›–ç´¢å¼•**

---

## ç´¢å¼•ç±»å‹

### èšç°‡ç´¢å¼•

> èšç°‡ç´¢å¼•ï¼ŒæŒ‰æˆ‘çš„æ„æ€æ¥è¯´å°±æ˜¯ï¼Œå…¶æŒ‡å‘çš„åœ°å€åŒ…å«è¡Œæ•°æ®çš„å…¨æ•°æ®ï¼Œå³æ‰¾åˆ°è¯¥ç´¢å¼•ï¼Œä½ å°±èƒ½é€šè¿‡ç´¢å¼•æŒ‡å‘çš„åœ°å€æ‰¾åˆ°ä½ éœ€è¦çš„æ‰€æœ‰æ•°æ®ã€‚æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªèšç°‡ç´¢å¼•ï¼Œå¯ä»¥ç­‰ä»·ç†è§£ä¸ºä¸»é”®ï¼Œå…¶å®ä»–å°±æ˜¯ä¸»é”®ï¼ˆæœ‰ä¸»é”®çš„æƒ…å†µä¸‹ï¼‰ã€‚
>  
> å®˜æ–¹åŸè¯ï¼š
>  
> The InnoDB term for a primary key index. InnoDB table storage is organized based on the values of the primary key columns, to speed up queries and sorts involving the primary key columns. For best performance, choose the primary key columns carefully based on the most performance-critical queries. Because modifying the columns of the clustered index is an expensive operation, choose primary columns that are rarely or never updated.
>  
> å¤§è‡´æ„æ€ï¼š
>  
> èšç°‡ç´¢å¼•æ˜¯InnoDBå¼•æ“ä¸­ä¸»é”®ç´¢å¼•çš„æœ¯è¯­ã€‚ä¸ºäº†åŠ å¿«ä¸»é”®åˆ—çš„æŸ¥è¯¢å’Œæ’åºï¼ŒInnoDBçš„èšç°‡ç´¢å¼•å­˜å‚¨çš„æ˜¯ä¸»é”®ç´¢å¼•åˆ—ã€‚æ‰€ä»¥é€‰æ‹©ä¸»é”®æ—¶éœ€è¦è®¤çœŸé€‰ï¼Œä¸ç„¶åæœŸç»´æŠ¤å¾ˆè´¹æ—¶é—´å’Œé’±ã€‚
>  
> å½“ç„¶ä¹Ÿæ˜¯ä¼šæœ‰æ„å¤–æƒ…å†µçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬å»ºè¡¨æ—¶æ²¡æœ‰é€‰æ‹©ä¸»é”®ï¼Œé‚£ä¹ˆMySQLä¼šå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ
>  
> â‘  èšç°‡ç´¢å¼•é»˜è®¤é€‰æ‹©ä¸»é”®ã€‚
>  
> â‘¡ å¦‚æœè¡¨ä¸­æ²¡æœ‰å®šä¹‰ä¸»é”®ï¼ŒInnoDBä¼šé€‰æ‹©ä¸€ä¸ªå”¯ä¸€ï¼ˆunique indexï¼‰çš„éç©ºç´¢å¼•ä»£æ›¿ã€‚
>  
> â‘¢ å¦‚æœæ²¡æœ‰ä¸Šé¢é‚£æ ·çš„ç´¢å¼•ï¼ŒInnoDBä¼šè‡ªåŠ¨åœ°åˆ›å»ºä¸€ä¸ª6å­—èŠ‚çš„éšå¼ä¸»é”®ä½œä¸ºèšç°‡ç´¢å¼•ã€‚

ä¸¾ä¸ªğŸŒ°ï¼Œæ¥è¯´æ˜èšç°‡ç´¢å¼•å…·ä½“çš„åŠŸèƒ½ã€‚

```sql
#æ•°æ®è¡¨æœ‰ä»¥ä¸‹å­—æ®µ
create table db_student(
    id int(8) unsigned auto_increment primary key,
    stu_num  varchar(8)  null,
    stu_name varchar(16) null,
    stu_age  int(3)      null,
    stu_sex  varchar(1)  null,
    constraint stu_num
    unique (stu_num)
);

insert into db_student(stu_num,stu_name,stu_age,stu_sex) values('2017','å¼ ä¸‰',20,'0');
insert into db_student(stu_num,stu_name,stu_age,stu_sex) values('2018','é‡Œæ–¯',20,'0');
insert into db_student(stu_num,stu_name,stu_age,stu_sex) values('2019','æå››',20,'0');
insert into db_student(stu_num,stu_name,stu_age,stu_sex) values('2020','ç‹äº”',20,'0');

# ä¸»é”®è‡ªå¢ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ç”¨æ’å…¥ï¼Œåœ¨æ•°æ®åº“ä¸­ä¼šè‡ªåŠ¨ä»1å¼€å§‹è‡ªå¢
```

å¯ä»¥çœ‹åˆ°ä¸»é”®æ˜¯idï¼Œé‚£ä¹ˆèšç°‡ç´¢å¼•å°±æ˜¯idï¼Œä½ åœ¨ä¸»é”®çš„ç´¢å¼•æ–‡ä»¶ä¸­æ‰¾åˆ°å¯¹åº”çš„åˆ—ï¼Œå‡è®¾ç´¢å¼•æ–‡ä»¶å¦‚ä¸‹ï¼ˆå®é™…ä¸æ˜¯ï¼Œåªæ˜¯ä¸ºäº†å¥½ä½“ç°å‡ºèšç°‡ç´¢å¼•ï¼‰ï¼š

| id | åœ°å€ |
| --- | --- |
| 1 | 0001 |
| 2 | 0002 |
| 3 | 0003 |
| 4 | 0004 |

```sql
# æ­¤æ—¶æˆ‘ä»¬æŸ¥è¯¢id=1çš„æ•°æ®
select * from db_student where id = 1;

# è¯­å¥å‘½ä¸­ç´¢å¼•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå»ç´¢å¼•æ–‡ä»¶æŸ¥è¯¢id=1çš„æ•°æ®è¡Œï¼Œæ‰¾åˆ°åï¼Œæ ¹æ®åœ°å€å»å­˜å‚¨å®é™…æ•°æ®çš„æ–‡ä»¶æ‰¾åˆ°è¯¥åœ°å€å­˜å‚¨çš„æ•°æ®ï¼Œé‡Œé¢ä¼šåŒ…å«ï¼ˆ'2017','å¼ ä¸‰',20,'0'ï¼‰
```

### éèšç°‡ç´¢å¼•

> éèšç°‡ç´¢å¼•ä¹Ÿå«äºŒçº§ç´¢å¼•ã€è¾…åŠ©ç´¢å¼•ã€æ™®é€šç´¢å¼•ã€‚
>  
> å®ƒçš„å¶å­èŠ‚ç‚¹æŒ‡å‘çš„æ˜¯ä¸»é”®ç´¢å¼•çš„åœ°å€ã€‚å‘½ä¸­éèšç°‡ç´¢å¼•åï¼Œé€šè¿‡éèšç°‡ç´¢å¼•æ–‡ä»¶æ‰¾åˆ°èšç°‡ç´¢å¼•æ–‡ä»¶çš„åœ°å€ï¼Œå†é€šè¿‡èšç°‡ç´¢å¼•æ–‡ä»¶æ‰¾åˆ°å¯¹åº”çš„æ•°æ®ï¼Œ<u>éèšç°‡ç´¢å¼•æ–‡ä»¶ --> èšç°‡ç´¢å¼•æ–‡ä»¶</u> çš„è¿™ä¸€è¿‡ç¨‹ä¹Ÿå«**å›è¡¨**ã€‚

|  | èšç°‡ç´¢å¼• | éèšç°‡ç´¢å¼• |
| --- | --- | --- |
| key | ç´¢å¼•åˆ—çš„å€¼ï¼ˆä¸èƒ½ä¸ºç©ºï¼‰ | ç´¢å¼•åˆ—çš„å€¼ï¼ˆå¯ä»¥ä¸ºç©ºï¼‰ |
| value | æŒ‡å‘æ•°æ®å­˜å‚¨åœ°å€ | æŒ‡åƒèšç°‡ç´¢å¼•æ–‡ä»¶åœ°å€ |
| å¶å­èŠ‚ç‚¹ | å­˜å‚¨å¯¹åº”çš„è¡Œæ•°æ®çš„åœ°å€ | å­˜å‚¨å¯¹åº”çš„ä¸»é”®å€¼ |

ä¸¾ä¸ªğŸŒ°

ä¸‹è¡¨ä¸­ï¼Œæ•°å­—åˆ—ä¸ºä¸»é”®ï¼ˆèšç°‡ç´¢å¼•ï¼‰ã€‚

![](https://masuo-github-image.oss-cn-beijing.aliyuncs.com/image/20220325105633.png#id=fUAee&originHeight=424&originWidth=631&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

å›¾æºï¼š[https://www.jianshu.com/p/fa8192853184](https://www.jianshu.com/p/fa8192853184)

### å•åˆ—ç´¢å¼•

> ä¸€ä¸ªç´¢å¼•åªåŒ…å«å•ä¸ªåˆ—ï¼Œä¸€ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªå•åˆ—ç´¢å¼•ï¼Œä½†è¿™ä¸æ˜¯ç»„åˆç´¢å¼•ã€‚

### ç»„åˆç´¢å¼•

> åˆç§°è”åˆç´¢å¼•ï¼Œè¯´çš„æ˜¯ä¸€ä¸ªç´¢å¼•åŒ…å«å¤šä¸ªåˆ—ã€‚
>  
> åˆ›å»ºç»„åˆç´¢å¼•åï¼Œç´¢å¼•æ–‡ä»¶ä¸­çš„å¶å­èŠ‚ç‚¹ä¼šåŒæ—¶åŒ…å«æ¯ä¸ªç´¢å¼•åˆ—çš„å€¼ï¼Œå¹¶æ ¹æ®å¤šåˆ—æ’åº

ä¸¾ä¸ªğŸŒ°

```sql
# å»ºè¡¨æ—¶å»ºç«‹ä¸»é”®
CREATE TABLE IF NOT EXISTS `db_stu`(
    `id` int(8) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    `stu_num` int(8),
    `stu_name` varchar(16),
    `stu_age` int(3)
)ENGINE=InnoDB;

# å»ºç«‹ç»„åˆç´¢å¼•,æ³¨æ„ï¼Œè¿™é‡Œä¸è¦åŠ idï¼Œå› ä¸ºå·²ç»å­˜åœ¨idç´¢å¼•æ–‡ä»¶äº†ï¼Œ
# ç»„åˆç´¢å¼•:id,stu_num,stu_nameåœ¨ä½¿ç”¨ä¸Šå¹¶ä¸ä¼šæ¯”ç»„åˆç´¢å¼•ï¼šstu_num,stu_name + ä¸»é”®ç´¢å¼•ï¼šidå¥½
CREATE INDEX index_union ON db_stu (stu_num,stu_name,stu_age);

insert into db_stu(stu_num,stu_name,stu_age) values('2017','å¼ ä¸‰',20);
insert into db_stu(stu_num,stu_name,stu_age) values('2018','ls',20);
insert into db_stu(stu_num,stu_name,stu_age) values('2019','é‡Œæ–¯',20);
insert into db_stu(stu_num,stu_name,stu_age) values('2020','æå››',20);
# æŸ¥çœ‹ç´¢å¼•
SHOW INDEX FROM db_stu;
```

![](https://masuo-github-image.oss-cn-beijing.aliyuncs.com/image/20220120154648.png#id=UNUdo&originHeight=289&originWidth=1316&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

#### æœ€å·¦åŒ¹é…

> è¯´åˆ°ç»„åˆç´¢å¼•ï¼Œé‚£å°±ä¸å¾—ä¸è¯´ä¸€ä¸‹æœ€å·¦åŒ¹é…åŸåˆ™äº†ã€‚
>  
> ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿ
>  
> åœ¨åˆ›å»ºäº†ç»„åˆç´¢å¼•ä¹‹åï¼Œå¹¶ä¸æ˜¯ `where`å­å¥ä¸­åŒ…å«ç»„åˆç´¢å¼•å°±èƒ½å‘½ä¸­ç»„åˆç´¢å¼•çš„ï¼Œæƒ³è¦å‘½ä¸­ç»„åˆç´¢å¼•æ—¶éœ€è¦ä¸€å®šæ¡ä»¶çš„ã€‚
>  
> æœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š[ç»„åˆç´¢å¼•](https://dev.mysql.com/doc/refman/5.7/en/multiple-column-indexes.html)ã€‚
>  
> å®˜æ–¹åŸè¯ï¼š
>  
> If the table has a multiple-column index, any leftmost prefix of the index can be used by the optimizer to look up rows. For example, if you have a three-column index on `(col1, col2, col3)`, you have indexed search capabilities on `(col1)`, `(col1, col2)`, and `(col1, col2, col3)`.
>  
> æœ€å·¦åŒ¹é…ç±»ä¼¼äºé€‰æ‹©çœå¸‚å¿æ—¶ï¼Œéœ€è¦å…ˆé€‰æ‹©çœï¼Œç¼©å°èŒƒå›´ï¼ˆç¡®å®šä¸‹ä¸€çº§èŒƒå›´ï¼‰è¿™ç§æ„æ€ã€‚
>  
> è¡¨ç¤ºå‡è®¾å¯¹è¡¨ä¸­çš„ï¼ˆAï¼ŒBï¼ŒCï¼‰å»ºç«‹ç»„åˆç´¢å¼•ï¼Œé‚£ä¹ˆèƒ½å‘½ä¸­ç´¢å¼•çš„åœºæ™¯å¦‚ä¸‹
>  
> - ï¼ˆAï¼ŒBï¼ŒCï¼‰ï¼ˆAï¼ŒBï¼‰ï¼ˆAï¼‰ï¼Œ
> - ä½¿ç”¨é€šé…ç¬¦æ—¶ï¼Œ

```sql
# è”åˆç´¢å¼•ä¸ºï¼ˆstu_num,stu_name,stu_ageï¼‰,èƒ½å‘½ä¸­ç´¢å¼•çš„æƒ…å†µå¦‚ä¸‹
explain select * from db_stu where stu_num='2017' and stu_name='ww' and stu_age=20;
explain select * from db_stu where stu_num='2017' and stu_name='ww';
explain select * from db_stu where stu_num='2017';

# å‰©ä¸‹çš„éƒ½ä¸èƒ½å‘½ä¸­ç´¢å¼•
explain select * from db_stu where stu_name = 'ww' and stu_age=20;
```

#### ç´¢å¼•ä¸‹æ¨

### å”¯ä¸€ç´¢å¼•

> å®ƒä¸æ™®é€šç´¢å¼•ç±»ä¼¼ï¼Œä¸åŒçš„å°±æ˜¯
>  
> - ç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œå…è®¸æœ‰ç©ºå€¼ã€‚
> - å¦‚æœæ˜¯ç»„åˆç´¢å¼•ï¼Œåˆ™åˆ—å€¼çš„ç»„åˆå¿…é¡»å”¯ä¸€ã€‚

### è¦†ç›–ç´¢å¼•

> ç”±äºéè¦†ç›–ç´¢å¼•çš„å¶å­èŠ‚ç‚¹æ²¡æœ‰å®Œæ•´çš„æ•°æ®ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦**å›è¡¨**ï¼Œæ¥ä¿è¯æˆ‘ä»¬èƒ½å–åˆ°è‡ªå·±æ‰€éœ€çš„æ•°æ®ï¼Œä½†æ˜¯å›è¡¨ç›¸å½“äºåˆè¿›è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼Œå¯èƒ½ä¼šæ¶‰åŠå¤šæ¬¡IOã€‚
>  
> è¦†ç›–ç´¢å¼•å¹¶ä¸æ˜¯ä¸€ç§çœŸçš„ç´¢å¼•ï¼Œä»–åªæ˜¯ä¸€ç§é’ˆå¯¹**å›è¡¨**çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚

ä¸¾ä¸ªğŸŒ°

```sql
# åˆ›å»ºä¸€ä¸ªè¡¨ï¼ŒæŸ¥è¯¢å…¶ä¸­çš„ä¸¤ä¸ªå€¼
create table db_test(
 `id` int auto_increment primary key,
    `name` varchar(16),
    `age` int(3)
)engine=innodb;

# åˆ›å»ºnameä¸ºæ™®é€šç´¢å¼•
create index index_name on db_test(name);

# æ’å…¥ç¤ºä¾‹æ•°æ®
insert into db_test(name,age) values('zs',20);
insert into db_test(name,age) values('ls',20);
insert into db_test(name,age) values('ww',20);
```

ä¸šåŠ¡åœºæ™¯ï¼šçœ‹å¦‚ä¸‹ä¿¡æ¯æŸ¥è¯¢çš„ä¸åŒ

```sql
# 
select id,name,age from db_test where name='zs';
select id,name from db_test where name='zs';
```

> é¦–å…ˆè¿™é‡Œæ¶‰åŠåˆ°äº†MySQLå­˜å‚¨ç´¢å¼•çš„æ–¹å¼ï¼Œéœ€è¦äº†è§£B+æ ‘çš„ç»“æ„ï¼Œè¿˜éœ€è¦äº†è§£ç´¢å¼•æ–‡ä»¶çš„ç»“æ„
>  
> ç¬¬ä¸€æ¡è¯­å¥æ‰§è¡Œé¡ºåºï¼šå…ˆå»nameçš„ç´¢å¼•æ–‡ä»¶æ‰¾åˆ°â€œzsâ€ï¼Œæ ¹æ®â€œzsâ€æ‰¾åˆ°æ•°æ®IDï¼Œå†æ ¹æ®IDï¼Œå»IDçš„ç´¢å¼•æ–‡ä»¶ï¼ˆèšç°‡ç´¢å¼•æ–‡ä»¶ï¼‰ä¸­å¯»æ‰¾åŒ¹é…çš„æ•°æ®ï¼Œè¿”å›æ•°æ®ã€‚
>  
> ç¬¬äºŒæ¡è¯­å¥æ‰§è¡Œé¡ºåºï¼šå»nameçš„ç´¢å¼•æ–‡ä»¶æ‰¾åˆ°â€œzsâ€ï¼Œæ ¹æ®â€œzsâ€æ‰¾åˆ°äº†IDï¼Œè¿™æ—¶å·²ç»æ‰¾åˆ°äº†æ‰€éœ€æ•°æ®ï¼Œç›´æ¥è¿”å›æ•°æ®ã€‚
>  
> ä¸Šé¢çš„ä¸åŒæ˜¯ï¼Œç¬¬äºŒæ¡è¯­å¥æ²¡æœ‰**å›è¡¨**ï¼Œä»…é è¾…åŠ©ç´¢å¼•å°±æ‰¾åˆ°äº†æ‰€éœ€çš„æ•°æ®ï¼Œè¿™å°±æ˜¯è¦†ç›–ç´¢å¼•ã€‚

## ç´¢å¼•æ“ä½œ

### å»ºè¡¨æ—¶æŒ‡å®šç´¢å¼•

```sql
# å»ºè¡¨æ—¶æ·»åŠ ä¸»é”®ç´¢å¼•
CREATE TABLE mytable(  
 `ID` INT NOT NULL,   
 `username` VARCHAR(16) NOT NULL,  
 PRIMARY KEY (`ID`));

# å»ºè¡¨æ—¶æ·»åŠ æ™®é€šç´¢å¼•
CREATE TABLE mytable(  
 `ID` INT NOT NULL,   
 `username` VARCHAR(16) NOT NULL,  
 INDEX [indexName] (username(length)));

# å»ºè¡¨æ—¶æŒ‡å®šå”¯ä¸€ç´¢å¼•
CREATE TABLE mytable(  
 `ID` INT NOT NULL,   
 `username` VARCHAR(16) NOT NULL,  
 UNIQUE [indexName] (username(length)));

# å»ºè¡¨æ—¶æ·»åŠ ç»„åˆç´¢å¼•
CREATE TABLE mytable(  
 `ID` INT NOT NULL,   
 `username` VARCHAR(16) NOT NULL,
    `userage` VARCHAR(16) NOT NULL,
 INDEX <indexName> (username,userage);
```

![](https://masuo-github-image.oss-cn-beijing.aliyuncs.com/image/20220114154335.png#id=Wphjc&originHeight=171&originWidth=497&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

#### æ·»åŠ ç´¢å¼•

> è¡¨æ„å»ºå®Œæˆï¼Œæœ€å¥½åœ¨æ·»åŠ æ•°æ®å‰å°±æƒ³å¥½å¦‚ä½•å»ºç«‹ç´¢å¼•ã€‚
>  
> æ·»åŠ ç´¢å¼•æœ‰ä¸¤ç§æ–¹å¼
>  
> - ALTER TABLE table_name ADD INDEX â€¦
> - CREATE INDEX â€¦ ON table_name ï¼Œï¼ˆæ¨èï¼Œç›¸å¯¹ä¿®æ”¹è¡¨ç»“æ„æ›´å¿«ï¼‰

```sql
# ä¿®æ”¹è¡¨ç»“æ„,æ·»åŠ æ™®é€šç´¢å¼•
ALTER TABLE <table_name> ADD INDEX <index_name>(column_name);

# ä¿®æ”¹è¡¨ç»“æ„,æ·»åŠ å”¯ä¸€ç´¢å¼•
ALTER TABLE <table_name> ADD UNIQUE <index_name>(column_name);

# ä¿®æ”¹è¡¨ç»“æ„ï¼Œæ·»åŠ å…¨æ–‡ç´¢å¼•
ALTER TABLE <table_name> ADD FULLTEXT <index_name>(column_name);


# æ·»åŠ æ™®é€šç´¢å¼•ï¼Œæœ€åè¿™ä¸ªæ‹¬å·å¿…é¡»è¦åŠ ,
CREATE INDEX <indexName> ON <table_name> (column_name);

# æ·»åŠ å”¯ä¸€ç´¢å¼•
CREATE UNIQUE INDEX <indexName> ON <table_name> (column_name);

# æ·»åŠ å…¨æ–‡ç´¢å¼•
CREATE FULLTEXT INDEX <indexName> ON <table_name> (column_name);
```

![](https://masuo-github-image.oss-cn-beijing.aliyuncs.com/image/20220114152544.png#id=WF0xy&originHeight=88&originWidth=488&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

![](https://masuo-github-image.oss-cn-beijing.aliyuncs.com/image/20220114152201.png#id=sFUaA&originHeight=85&originWidth=532&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

### æŸ¥çœ‹ç´¢å¼•

```sql
SHOW INDEX FROM <table_name>;
```

![](https://masuo-github-image.oss-cn-beijing.aliyuncs.com/image/20220114155321.png#id=RYEYi&originHeight=176&originWidth=1305&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

> **Table:** è¡¨å
>  
> **Non_unique:** æ˜¯å¦ä¸ºå”¯ä¸€ç´¢å¼•ï¼Œ0ä¸ºæ˜¯ï¼Œ1ä¸ºä¸æ˜¯ã€‚
>  
> **Key_name ç´¢å¼•åç§°**ï¼Œå¦‚æœåå­—ç›¸åŒåˆ™è¡¨æ˜æ˜¯åŒä¸€ä¸ªç´¢å¼•ï¼Œè€Œå¹¶ä¸æ˜¯é‡å¤ï¼Œæ¯”å¦‚ä¸Šå›¾ä¸­çš„ç¬¬å››ã€äº”æ¡æ•°æ®ï¼Œç´¢å¼•åç§°éƒ½æ˜¯**name**ï¼Œå…¶å®æ˜¯ä¸€ä¸ªè”åˆç´¢å¼•ã€‚
>  
> **Seq_in_index** ç´¢å¼•ä¸­çš„åˆ—åºåˆ—å·ï¼Œä»1å¼€å§‹ã€‚ä¸Šå›¾ä¸­çš„å››ã€äº”æ¡æ•°æ®ï¼Œ**Seq_in_index**ä¸€ä¸ªæ˜¯1ä¸€ä¸ªæ˜¯2ï¼Œå°±æ˜¯è¡¨æ˜åœ¨è”åˆç´¢å¼•ä¸­çš„é¡ºåºï¼Œæˆ‘ä»¬å°±èƒ½æ¨æ–­å‡ºè”åˆç´¢å¼•ä¸­ç´¢å¼•çš„å‰åé¡ºåºã€‚
>  
> **Column_name** ç´¢å¼•çš„åˆ—åã€‚
>  
> **Collation**æŒ‡çš„æ˜¯åˆ—ä»¥ä»€ä¹ˆæ–¹å¼å­˜å‚¨åœ¨ç´¢å¼•ä¸­ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯å­—ç¬¦åºã€‚
>  
> **Cardinality** æ˜¯åŸºæ•°çš„æ„æ€ï¼Œè¡¨ç¤ºç´¢å¼•ä¸­å”¯ä¸€å€¼çš„æ•°ç›®çš„ä¼°è®¡å€¼ã€‚æˆ‘ä»¬çŸ¥é“æŸä¸ªå­—æ®µçš„é‡å¤å€¼è¶Šå°‘è¶Šé€‚åˆå»ºç´¢å¼•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯æ ¹æ®**Cardinality**æ¥åˆ¤æ–­ç´¢å¼•æ˜¯å¦å…·æœ‰é«˜é€‰æ‹©æ€§ï¼Œå¦‚æœè¿™ä¸ªå€¼éå¸¸å°ï¼Œé‚£å°±éœ€è¦é‡æ–°è¯„ä¼°è¿™ä¸ªå­—æ®µæ˜¯å¦é€‚åˆå»ºç«‹ç´¢å¼•ã€‚
>  
> **Sub_part** å‰ç½®ç´¢å¼•çš„æ„æ€ï¼Œå¦‚æœåˆ—åªæ˜¯è¢«éƒ¨åˆ†åœ°ç¼–å…¥ç´¢å¼•ï¼Œåˆ™ä¸ºè¢«ç¼–å…¥ç´¢å¼•çš„å­—ç¬¦çš„æ•°ç›®ã€‚å¦‚æœæ•´åˆ—è¢«ç¼–å…¥ç´¢å¼•ï¼Œåˆ™ä¸ºNULLã€‚
>  
> **Packed** æŒ‡ç¤ºå…³é”®å­—å¦‚ä½•è¢«å‹ç¼©ã€‚å¦‚æœæ²¡æœ‰è¢«å‹ç¼©ï¼Œåˆ™ä¸ºNULLã€‚å‹ç¼©ä¸€èˆ¬åŒ…æ‹¬å‹ç¼©ä¼ è¾“åè®®ã€å‹ç¼©åˆ—è§£å†³æ–¹æ¡ˆå’Œå‹ç¼©è¡¨è§£å†³æ–¹æ¡ˆã€‚
>  
> **Null** å¦‚æœåˆ—å«æœ‰NULLï¼Œåˆ™å«æœ‰YESã€‚
>  
> **Index_type**è¡¨ç¤ºç´¢å¼•ç±»å‹ï¼ŒMysqlç›®å‰ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ç´¢å¼•ç±»å‹ï¼šFULLTEXTï¼ŒHASHï¼ŒBTREEã€‚
>  
> **Comment Index_comment** æ³¨é‡Šçš„æ„æ€ã€‚

### åˆ é™¤ç´¢å¼•

åŒæ·»åŠ ç´¢å¼•ï¼Œä¸€æ ·æœ‰ä¸¤ç§æ–¹å¼åˆ é™¤ç´¢å¼•

- DROPï¼Œç›´æ¥åˆ é™¤ç´¢å¼• ï¼ˆæ¨èï¼Œç›¸æ¯”ä¿®æ”¹è¡¨ç»“æ„æ›´å¿«ï¼‰
- ALTERï¼Œä¿®æ”¹è¡¨ç»“æ„

```sql
# ç›´æ¥åˆ é™¤,å¦‚æœä¸å†™çš„è¯ï¼Œé»˜è®¤åˆ é™¤å…¨éƒ¨
DROP INDEX [index_name] ON <table_name>

# ä¿®æ”¹è¡¨ç»“æ„
ALTER TABLE <table_name> DROP INDEX <index_name>
```

![](https://masuo-github-image.oss-cn-beijing.aliyuncs.com/image/20220114155433.png#id=duIJh&originHeight=184&originWidth=1303&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
